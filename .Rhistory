plot(res,choix="ind",habillage=17)
plot(res , choix="var") #qu'est ce que je veux masquer #enlever les indiv supp
#6
dimdesc(res)
round(res$ind$contrib,2)
#7
res$eig
#8
#9
res$ind
#si on veut voir les données sur les ind sup
res$ind.sup
#10,11
sort(round(res$ind$contrib[,1],2))
sort(round(res$ind$contrib[,2],2))
#12
sort(round(res$ind$cos2[,1]+res$ind$cos2[,2],3))
#14
res.pca$var
#17
res$quali.sup
#18
#scale
#Par défault centrés
scale(t[1:23,1:16])
#19
cor(t[,1:16])
cor(t[1:23,1:16])
#19
cor(t[1:23,1:16])
#19
cor(t[,1:16])
knitr::opts_chunk$set(echo = TRUE)
baseC=read.csv("femme_travail.csv",sep = ";",row.names = 1,header = T)
baseC
baseC=read.csv("femme_travail.csv",sep = ";",row.names = 1,header = T)
baseC
```{r}
baseC=read.csv("femme_travail.csv",sep = ";",row.names = 1,header = T)
baseC
baseC=read.csv(file.choose(),sep = ";",row.names = 1,header = T)
baseC
View(baseC)
summary(baseC)
round(resultat$expected,2)
resultat=chisq.test(baseC[,1:3])
resultat
round(resultat$expected,2)
res$eig
barplot(res$eig)
barplot(res$eig[2,])
barplot(res$eig)
barplot(res$eig[,1])
plot.CA(res)
plot.CA(res,invisible = "row")
plot.CA(res,invisible = "row")
View(baseC)
summary(baseC)
resultat=chisq.test(baseC[,1:3])
resultat
round(resultat$expected,2)
res$eig
barplot(res$eig[,1])
plot.CA(res,invisible = "row")
View(res)
View(res)
res=CA(db[,1:3])
res=CA(baseC[,1:3])
res=CA(baseC[,1:3])
res$eig
barplot(res$eig[,1])
plot.CA(res,invisible = "row")
res$col
plot.CA()
plot.CA(res)
res.ca1=CA(baseC,col.sup = 4:ncol(baseC))
#Q1
credit<-read.csv("Credit.csv",header=T , sep=";",dec=".")
getwd()
#Q1
credit<-read.csv("Credit.csv",header=T , sep=";",dec=".")
getwd()
#Q2
str(credit)
credit
#On doit convertir la var age en qualitative par l'aura besoin
credit[,"Age"]<-as.factor(credit[,"Age"])
for(i in 1:ncol(credit)){
par(ask=TRUE) #Permet de voir graphe le 1 par 1
plot(credit[,i])
}
for(i in 1:ncol(credit)){
par(ask=TRUE) #Permet de voir graphe le 1 par 1
plot(credit[,i])
}
View(credit)
#Un seul indiv prent la modalité Sidecar de la var Mache
#On réalise un regroupement naturel de Sidecar avec Moto
levels(credit[,"Marche"])
barplot(res.acm$eig[,1])
#Q4
res.acm=MCA(credit,quali.sup=6:11,level.ventil=0)
str(credit)
credit
#On doit convertir la var age en qualitative par l'aura besoin
credit[,"Age"]<-as.factor(credit[,"Age"])
for(i in 1:ncol(credit)){
par(ask=TRUE) #Permet de voir graphe le 1 par 1
plot(credit[,i])
}
levels()
library("FactoMineR")
#Un seul indiv prent la modalité Sidecar de la var Mache
#On réalise un regroupement naturel de Sidecar avec Moto
levels(credit[,"Marche"])
levels(credit[,"Marche"])[5]<-"Moto"
#Q4
res.acm=MCA(credit,quali.sup=6:11,level.ventil=0)
#Q4
res.acm=MCA(credit,quali.sup=6:11,level.ventil=0)
barplot(res.acm$eig[,1])
res.acm$eig
#Q6
plot(res.acm, invisible=c("var","quali.sup"))
#Q6
plot(res.acm, invisible=c("quali.sup"))
dim(credit)
#Q6
plot(res.acm, invisible=c("var","quali.sup","ind"))
#Onutilise bcp l'habillage dans L'ACM on vise typologie
plot(res.acm, invisible=c("var","quali.sup"),habillage="Marche")
#Onutilise bcp l'habillage dans L'ACM on vise typologie
plot(res.acm, invisible=c("var","quali.sup"),habillage="Marche")
#Onutilise bcp l'habillage dans L'ACM on vise typologie
plot(res.acm, invisible=c("var","quali.sup"),habillage="Endettement")
#Onutilise bcp l'habillage dans L'ACM on vise typologie
plot(res.acm, invisible=c("var","quali.sup"),habillage="Marche")
#Onutilise bcp l'habillage dans L'ACM on vise typologie
plot(res.acm, invisible=c("var","quali.sup"),habillage="Age")
#Q7
plot(res.acm,invisible="ind")
plot(res.acm,choix = "var")
#pour financer des travaux de rénovation oposser a des personnes plus jeunes qui ont
#contracter des credits pour acheter un scooter une voiture etc...
#les jeunes ont tendance a avoir un taux d endaitement plus élévé
#le deuxime axe:oposse principalement les individus qui ont des problemes financiers en bas
#aux autres en haut on retrouve ainsi en bas les personnes qui ont des difficultés à
#rembourser leur credit (impéyer 3 ou plus) et qui sont souscrit à l'assurance AID plus
#chomage
#question8
#ACM:graphe de smodalités
#la relation entre les variables quali et les dimension globalement
plot(res.mca,choix="var")
res.acm$var$contrib
res.acm$var$contrib
#Q9
res.acm$var$eta2
#Q10
dimdesc(res.acm)
#Q10
dimdesc(res.acm)
sum(res.acm$var$contrib)
plot(res.mca,invisible = c("var","quali.sup"),axes = 3:4)
#Q11
plot(res.acm, invisible=c("var","quali.sup"),habillage="Marche",axes = 3:4)
#Q11
plot(res.acm, invisible=c("var","quali.sup"),habillage="Marche",axes = 3:4)
#1
library(FactoMineR)
?summary(aov)
#App1
data1=chickwts
data1
tapply(data1$weight,data1$feed,summary)
#appliquer summary de chaque echantillon de weight en fonction de feed
#effecet de la variable narroutire sur la masse des poulets
plot(data1$weight~data1$feed,data=data1)
#variabilitÃ© intergroupe(whoudlfouk whoud louta)
model1=lm(data1$weight~data1$feed)
summary(model1)
#on accepte h0 parceque c'est supÃ©rieur Ã  0.05
#teste d'homoscÃ©dasticitÃ© : on teste l'homogÃ©nietÃ© des variances
#h0:les variances sont Ã©gales(homogÃ©nes)
#h1:il existe au moins deux variances diffÃ©rents
bartlett.test(data1$weight~data1$feed,data=data1)
#calcul les variances intragroupes
#on accepte car 0.66>0.05:proba rejetÃ© h0 sachant h0 est vrai
#boxplot pour les valeurs abÃ©rent
anova(model1)
#calcul les variances intragroupes
#on accepte car 0.66>0.05:proba rejetÃ© h0 sachant h0 est vrai
#boxplot pour les valeurs abÃ©rent
a=anova(model1)
#on rejette H0 p value inferieur a 0.01
#???un effet de la variable quali sur la variable quanti
#Tukey HSD
#detecter au seuil de 5% quel sont les moyennes sginificativement differentes
#A PRIORI UNE DIFFERENCE SIGNIFICATIVE AVEC TR1 ET TR3
TukeyHSD(a)
a=aov(data1$weight~data~field)
a=aov(data1$weight~data1$feed)
#on rejette H0 p value inferieur a 0.01
#???un effet de la variable quali sur la variable quanti
#Tukey HSD
#detecter au seuil de 5% quel sont les moyennes sginificativement differentes
#A PRIORI UNE DIFFERENCE SIGNIFICATIVE AVEC TR1 ET TR3
TukeyHSD(a)
conso=read.table(file = file.choose(),sep=';',header=T,row.names = 1)
conso
View(conso)
res.pca$eig
#tranches d'age et de d1 vers d10 et ensemble represente la tranche d'age
#moyenne pour toute la france
#depense totaux , rubriques
#n individus n variable et quali quanti
#caractÃ©riser les tranche d age avec les diffÃ©rents ribrique
#ensemble:redandance d'inforamtion
library(FactoMineR)
res.pca=PCA(conso,ind.sup=8:18,quanti.sup=27:30)
res.pca$eig
#quest7:
plot.PCA(res.pca,choix='ind',invisible="ind.sup")
#corelation variable
#individu proche ou nn
#premier axe oposoe les tranches d'ages ectreme et tranche d'ages moyenne
#l'axe 2 range les tranches d'ages de la plus haute Ã  la plus basse
#c-
res.pca$ind
#â»pratiquement logement eau gaz ortogonale avec les autres variables
#fromage ..
#g-
plot.PCA()
#premier axe
#coff de correlation 0.99 on peut nommer la premiere composant comme axe
#  de variabilitÃ© de consomm produit alimentaire
plot.PCA(res.pca,choix="ind",invisible = "ind")
#â»pratiquement logement eau gaz ortogonale avec les autres variables
#fromage ..
#g-
plot.PCA(res.pca)
#â»pratiquement logement eau gaz ortogonale avec les autres variables
#fromage ..
#g-
plot(res.pca)
#â»pratiquement logement eau gaz ortogonale avec les autres variables
#fromage ..
#g-
plot(res.pca)
#premier axe
#coff de correlation 0.99 on peut nommer la premiere composant comme axe
#  de variabilitÃ© de consomm produit alimentaire
plot.PCA(res.pca,choix="var",invisible = "ind")
#premier axe
#coff de correlation 0.99 on peut nommer la premiere composant comme axe
#  de variabilitÃ© de consomm produit alimentaire
plot.PCA(res.pca,choix="var",invisible = "quali.sup")
#premier axe
#coff de correlation 0.99 on peut nommer la premiere composant comme axe
#  de variabilitÃ© de consomm produit alimentaire
plot.PCA(res.pca,choix="var",invisible = "quali")
#premier axe
#coff de correlation 0.99 on peut nommer la premiere composant comme axe
#  de variabilitÃ© de consomm produit alimentaire
plot.PCA(res.pca,choix="var",invisible = "quanti.sup")
data=read.table(file = file.choose(),sep=";",header = T,row.names = 1)
data
data1=read.table(file = file.choose(),sep=";",header = T,row.names = 1)
View(data1)
data1
#des reseultat contradictoire donc si on repond a chaque question a part on doit
#avoir des resultat fragiles
#la valeur Ã©levÃ© soit total colonne elvÃ© soit total ligne
View(data)
#des reseultat contradictoire donc si on repond a chaque question a part on doit
#avoir des resultat fragiles
#la valeur Ã©levÃ© soit total colonne elvÃ© soit total ligne
#1724 femme ont repondu a trois questions differetes:question 1
#question 2 question 3
resultat=chisq.test(data[,1:3])
resultat
#on rejette h0 on a une dependance entre les deux variables
#8)
round(resultat$expected,2)
#9)
library(FactoMineR)
res.ca=CA(data[,1:3])
res.ca=CA(data[,1:3])
res.ca=CA(data[,1:3])
res.ca=CA(data[,1:3])
#l origine du plan factoriel est confondu avec le profil moyen (baricentre)
#de chacun des deux nuages
plot.CA(res.ca,invisible = "row")
#le premier axe reprÃ©sente l attitude envers le travail feminin il range les
#modalitÃ©s de la seconde variable le premier axe represente l'attitude envers
#le travail feminin il range les modalitÃ©s de la seconde variable depuis la
#plus dÃ©favorable(rester au foyer) jusqu a la plus favorable(travail plein temps)
res.ca$col
?CA
#contrib:construction du plan
#cos:qualitÃ©
plot.CA(res.ca,invisible = "col")
#meme interpretation que l autre
#on peut nommer cet axe attitude à l'égart travail feminin
#disposition ordonnée des modalités qui sont en faveur ou bien non avec le travail
#femin
#en peut illustrer cette disposition en se référant au profil ligne
plot.CA(res.ca)
#10) 86.29 de la liaison est exprimÃ© en premier axe:part de liaison
#â le premier axe represente 86.29% de la liaison entre les deux variables
#c a d la quasi totalitÃ© de l'ecart entre le tableau de donnÃ©es obsÃ©rvÃ©
#et le modÃ©le d'independance
res.ca$eig
baseC=read.csv(file.choose(),sep = ";",row.names = 1,header = T)
baseC
library("FactoMineR")
res.pca=PCA(baseC,ind.sup = 8:18,quanti.sup = 27:30)
res.pca$eig
sum(res.pca$eig[,1]]
#3 pour obtenir une typologie des classe d'age fondé sur leur depense on defint la distance entre 2 classe d'ages
#uniquement sur la base de leurs depenses sur les diff rubrique
#toto ne sont pas des variable mais considéées comme des variable supplémentaire
#6
barplot(res.pca$eig[,1],)
#7
plot.PCA(res.pca,choix = "ind",invisible = "ind.sup")
"Le 1er axe oppose les tranches d'age moyenne au tranche d'age extreme
Pour l'axe 2 range les tranches d'age de la plus haute au plus basse"
'c-'
res.pca$ind
sort(round(res.pca$ind$cos2[,1]+res.pca$ind$cos2[,2],2))
#8
'a-'
plot.PCA(res.pca,choix = "var",invisible = "quanti.sup")
'b-'
"tte les variables sont correle positivement au 1er axe sauf gaz et eau "
"les tranches d'ages moins agées sont plus liées au  "
'c'
res.pca$var
sort(round(res.pca$var$contrib[,1],2))
sort(round(res.pca$var$contrib[,1]+res.pca$var$contrib[,2],3))
'd-'
sort(round(res.pca$var$cos2[,1]+res.pca$var$cos2[,2],2))
""
'-e,f'
'matrice de correlation'
round(cor(baseC[,c(1,4,17)]),2)
"les 3 var ne sont pas correllées"
'g'
plot.PCA(res.pca,choix = "var",invisible = "var")
res.pca$quanti.sup$cor
"correllation tres forte alimentaire et 1 er axe de variabilité"
#9
"1er axe : oppose les tranches d'age qui depense bcp avec celle qui consomme pe cette 1er composante est tres
liées au depense alimentaire ce qui est bien resumé par la forte coorelation de la var supp total aimentation avec
le 1er axe(0.99)
rappelond=s aussi que la 1er composante principale est la comb lineaire de l'nensemble des var qui la
synthetise le mieu
le 2em axe oppose principalement de poisson huile santé avec logement gaz electricite tabac communication
restauration cet axe separe globalement les classe d'age qui depense peu
les moins agé consomme tabac et les personne agée presente un profil de depense opposée
"
"Enrichir l'interpretation"
'1-'
plot.PCA(res.pca,choix = "ind",invisible = "ind")
"on peut interpreter que la consommation s"
'2-'
"anallyse conjointe entre individus et variable"
plot.PCA(res.pca,choix = "ind",axes = 2:3)
plot.PCA(res.pca,choix = "var",axes = 2:3)
"l'axe 3 est essentiellement est tres liée a la var enseignement
il oppose principalement les tranches d'ae 25-34 au tranxhe moins de 25 et 45-54 qui depense que les aures
en enseignement
"
sum(res.pca$eig[,1])
data1
#des reseultat contradictoire donc si on repond a chaque question a part on doit
#avoir des resultat fragiles
#la valeur Ã©levÃ© soit total colonne elvÃ© soit total ligne
#1724 femme ont repondu a trois questions differetes:question 1
#question 2 question 3
resultat=chisq.test(data[,1:3])
resultat
#on rejette h0 on a une dependance entre les deux variables
#8)
round(resultat$expected,2)
#9)
library(FactoMineR)
res.ca=CA(data[,1:3])
#10) 86.29 de la liaison est exprimÃ© en premier axe:part de liaison
#â le premier axe represente 86.29% de la liaison entre les deux variables
#c a d la quasi totalitÃ© de l'ecart entre le tableau de donnÃ©es obsÃ©rvÃ©
#et le modÃ©le d'independance
res.ca$eig
barplot(res.ca$eig)
#l origine du plan factoriel est confondu avec le profil moyen (baricentre)
#de chacun des deux nuages
plot.CA(res.ca,invisible = "row")
#le premier axe reprÃ©sente l attitude envers le travail feminin il range les
#modalitÃ©s de la seconde variable le premier axe represente l'attitude envers
#le travail feminin il range les modalitÃ©s de la seconde variable depuis la
#plus dÃ©favorable(rester au foyer) jusqu a la plus favorable(travail plein temps)
res.ca$col
#contrib:construction du plan
#cos:qualitÃ©
plot.CA(res.ca,invisible = "col")
#meme interpretation que l autre
#on peut nommer cet axe attitude à l'égart travail feminin
#disposition ordonnée des modalités qui sont en faveur ou bien non avec le travail
#femin
#en peut illustrer cette disposition en se référant au profil ligne
plot.CA(res.ca)
?CA
barplot(res.acm$eig[,1])
#Q1
credit<-read.csv("Credit.csv",header=T , sep=";",dec=".")
credit
#On doit convertir la var age en qualitative par l'aura besoin
credit[,"Age"]<-as.factor(credit[,"Age"])
#Q3
for(i in 1:ncol(credit)){
par(ask=TRUE) #Permet de voir graphe le 1 par 1
plot(credit[,i])
}
#On réalise un regroupement naturel de Sidecar avec Moto
levels(credit[,"Marche"])[5]<-"Moto"
#Q4
res.acm=MCA(credit,quali.sup=6:11,level.ventil=0)
#Q4
res.acm=MCA(credit,quali.sup=6:11,level.ventil=0)
barplot(res.acm$eig[,1])
res.acm$eig
#Q6
plot(res.acm, invisible=c("var","quali.sup"))
#Onutilise bcp l'habillage dans L'ACM on vise typologie
plot(res.acm, invisible=c("var","quali.sup"),habillage="Marche")
#Q7
plot(res.acm,invisible="ind")
#Q7
plot(res.acm,invisible="ind")
plot(res.acm,choix = "var")
#Q9
res.acm$var$eta2
#pour financer des travaux de rénovation oposser a des personnes plus jeunes qui ont
#contracter des credits pour acheter un scooter une voiture etc...
#les jeunes ont tendance a avoir un taux d endaitement plus élévé
#le deuxime axe:oposse principalement les individus qui ont des problemes financiers en bas
#aux autres en haut on retrouve ainsi en bas les personnes qui ont des difficultés à
#rembourser leur credit (impéyer 3 ou plus) et qui sont souscrit à l'assurance AID plus
#chomage
#question8
#ACM:graphe de smodalités
#la relation entre les variables quali et les dimension globalement
plot(res.acm,choix="var")
#la varible marche:deux modalite on valeur tres elve
#varible marche a contibue le plus dans la contruction du premier axe
#deuxieme axe: impeyer qui a contibuer le plus
#9
res.acm$var$eta2
the=read.table(file = file.choose(),sep = ";",header=T)
str(the)
summary(the)
View(the)
#seulement age car c est la seul qui est quanti supp
barplot(res.mca$eig[,2])
res.mca<-MCA(the,quanti.sup = 22,quali.sup = c(19:21,23:36))
#seulement age car c est la seul qui est quanti supp
barplot(res.mca$eig[,2])
#entre les deux types de graphes
#decroissance legere est plus remarquable que la cassure
#on remarque une deroissance legere dans le graphe des valeurs propres il peut etre interessant
#d'interpreter les autres axes apres l interpretation du premier plan
#le premier plan represente 18% de l'information qui existe dans le jeu de donnees
#le cas ideale pour expliquer la relation entre deux variable quali min(k,j)=>tp
#5.1
plot(res.mca,invisible = c("var","quali.sup"),cex=0.7)
#quanti ala cercle de correlation
#5.2)â¢on a pas de particularite on peut faire une sorte d habillage
#le graphe des individues:on a pas de forme particuliÃ©re voir des groupes d individus particuler
#5.3)
res.mca$ind$coord[200,]
res.mca$ind$coord[262,]
#â opposÃ© par rapport au premier axe:les couples
data1=the[c(200,262,265,273),]
data1
#quanti ala cercle de correlation
#5.2)â¢on a pas de particularite on peut faire une sorte d habillage
#le graphe des individues:on a pas de forme particuliÃ©re voir des groupes d individus particuler
#5.3)
res.mca$ind$coord[200,]
res.mca$ind$coord[262,]
#â opposÃ© par rapport au premier axe:les couples
data1=the[c(200,262,265,273),]
data1
View(data1)
#deux couples:les individus 200 et 262 (respectivement 265 273) sont proches dans le plan
#factoriel car ils ont beacoup de modalitÃ© en communs
#ces deux couples sont elognÃ© l'un de l autre(oposÃ© sur le premier axe)car ils ont tres peu
#de modalitÃ© en commun
#le premier couple 273 ey=t 265 sont des amateur de thÃ© qui boivent rÃ©gulierement et
#les autres individus ne boivent pas du thÃ© que dans la maison occationnelement
#buveur regulier et buveur occasionnel
#type elle possÃ©de 6 modalitÃ©
#sucre deux modalie
#type elle possÃ©de linertie la plus elevÃ©
plot(res.mca,invisible = c("ind","quali.sup"),cex=0.7)
#active wahadhom w el ilustratif wahadhom puis on combine
#la partie negative l axe lowel kolhom pas
#interpretation:le premier axe oppose les buveurs regulier aux buveur occasionnel
#on confirme l hypothese andi f negative pas pas w lokhra salon de the vrac
#pas travail:m  yochrob the fel khedma
plot(res.mca,invisible = c("ind","var"),cex=0.7)
help("stack")
